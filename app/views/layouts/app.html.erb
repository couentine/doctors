<!DOCTYPE html>
<html>

  <head>
    <% #=== PAGE TITLE & APP ICON ===# %>
      
      <% if content_for? :full_title %>
        <title><%= yield(:full_title) %></title>
      <% else %>
        <title><%= full_title(yield(:title)).html_safe %></title>
      <% end %>
      <link rel="icon" type="image/png" href="<%= image_path('badge-list-icon-32-square.png') %>"/>
    
    <% #=== ANALYTICS, FONTS, ICONS, SHIM, ETC. ===# %>
      
      <%= render 'layouts/shared/analytics' if Rails.env.production? %>
      <%= render 'layouts/shared/fonts' %>
      <link rel="stylesheet" 
        href="https://fonts.googleapis.com/icon?family=Material+Icons">
      <%= render 'layouts/shared/shim' %>
      <%= csrf_meta_tags %>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <% #=== APP STYLES & SCRIPTS ===# %>

      <%= stylesheet_link_tag 'app', media: 'all' %>
      <%= javascript_include_tag 'app' %>
      <%= html_import_tag 'application' %>
      <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"> 
      </script>
    
    <% #=== OPTIONAL INCLUSIONS ===# %>
    <% #=== [:no_index, :include_ob_issuer, :include_stripe, :include_metadata, :header] ===# %>

      <% if content_for? :no_index %>
        <meta name="robots" content="noindex">
      <% end %>
      
      <% if content_for? :include_ob_issuer %>
        <script src="https://backpack.openbadges.org/issuer.js"></script>
        <script type="text/javascript">
          var obIssuerPresent = true;
        </script>
      <% end %>

      <%= render 'shared/stripe' if content_for? :include_stripe %>

      <% if content_for? :include_metadata %>
        <!-- === OPEN GRAPH METADATA === -->
        <meta property="og:type" content="Article" />
        <meta property="og:title" content="<%= yield(:metadata_title) %>" />
        <meta property="og:description" content="<%= yield(:metadata_description) %>" />
        <meta property="og:site_name" content="<%= yield(:metadata_site_name) %>" />
        <meta property="og:url" content="<%= yield(:metadata_url) %>" />
        
        <meta property="og:image" content="<%= yield(:metadata_image) %>" />
        <% if content_for?(:metadata_image_width) && content_for?(:metadata_image_height) %>
          <meta property="og:image:width" content="<%= yield(:metadata_image_width) %>" />
          <meta property="og:image:height" content="<%= yield(:metadata_image_height) %>" />
        <% end %>
        
        <!-- === TWITTER CARD METADATA === -->
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@badgelist" />
        <meta name="twitter:title" content="<%= yield(:metadata_title) %>" />
        <meta name="twitter:description" content="<%= yield(:metadata_description) %>" />
        <meta name="twitter:image" content="<%= yield(:metadata_image) %>" />
        <meta name="twitter:url" content="<%= yield(:metadata_url) %>" />
      <% end %>

      <%= yield(:header) if content_for? :header %>
  
  </head>

  <% #=== PAGE BODY ===# %>

  <body class="<%= yield(:body_class) if content_for?(:body_class) %>" 
    unresolved>
      
    <% #=== PAGE ALERTS ===# %>

      <% unless false && flash.blank? %>
        <bl-toast-container>
          <% flash.each do |key, value| %>
            <bl-toast text="<%= value %>" class="<%= key %>"></bl-toast>
          <% end %>
        </bl-toast-container>
      <% end %>

    <% #=== PAGE CONTENT (HEADER & FOOTER IS HANDLED IN APP CONTAINER COMPONENT) ===# %>

      <%= yield %>

  </body>

</html>