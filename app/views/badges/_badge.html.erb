<div class="info-card badge-card <%= (current_user && current_user.expert_of?(badge)) ? 'awarded' : '' %>" 
  data-bl-dyncol="child">
  <table>
    <tr class="card-image-row">
      <td>
        <% if current_user && current_user.expert_of?(badge) %>
          <div class="big-icon awarded">
            <i class="fa fa-check-circle"></i>
          </div>
        <% elsif current_user && current_user.learner_of?(badge) %>
          <div class="big-icon">
            <i class="fa fa-flag"></i>
          </div>
        <% end %>
        <%= link_to image_tag(group_badge_path(badge.group, badge, format: :png)), 
          group_badge_path(badge.group, badge), title: badge.name %><br/>
      </td>
    </tr>
    <tr class="card-body-row">
      <td class="card-body">
        <span class="card-headline">
          <%= link_to badge.name, group_badge_path(badge.group, badge), title: badge.name %>
        </span>
        <span class="card-text">
          <p><%= badge.summary %></p>
          
          <% if badge.has_requirements? %>
            <h4>Required Evidence</h4>
            <ul class="topic-list">
              <% badge.requirements.each do |tag| %>
                <li>
                  <%
                    icon_text = "<span class='fa-stack single-stack'>" \
                      + "<i class='fa fa-square fa-stack-2x'></i>"      \
                      + "<i class='fa #{tag.format_icon} fa-stack-1x fa-inverse'></i></span>"
                  %>
                  <%= link_to "#{icon_text} #{tag.display_name}".html_safe, 
                    group_badge_path(badge.group, badge) + "/" + tag.name_with_caps %>
                  <%= 
                    link_to "<i class='fa #{tag.format_icon}'></i> Post".html_safe, 
                      new_group_badge_log_entry_path(badge.group, badge, \
                      current_user.find_log(badge), tag: tag.name_with_caps), 
                      class: 'btn btn-mini' \
                    if current_user && \
                      (current_user.learner_of?(badge) || current_user.expert_of?(badge))
                  %>
                </li>
              <% end %>
            </ul>
          <% end %>
        </span>
      </td>
    </tr>
    <tr class="card-footline-row">
      <td class="card-footline">
        <ul class="left-foot">
          <% if current_user && current_user.expert_of?(badge) %>
            <li class="foot-text"><%= badge.Expert %></li>
          <% elsif current_user && current_user.learner_of?(badge) %>
            <li class="foot-text"><%= badge.Learner %></li>
          <% elsif badge.tracks_progress? && current_user \
            && (badge.group.open? || current_user.member_of?(badge.group) \
              || current_user.admin_of?(badge.group)) %>
            <li>
                <%= link_to '<i class="fa fa-plus-circle"></i> Join Badge'.html_safe, 
                    group_badge_logs_path(badge.group, badge), method: :post, class: 'btn btn-mini' %>
            </li>
          <% end %>
        </ul>
        <ul class="right-foot">
          <% if badge.tracks_progress? %>
            <li data-toggle="tooltip" data-placement="bottom" title="<%= badge.Learners %>">
              <i class="fa fa-users"></i> 
              <%= badge.learner_logs.count %>
            </li>
          <% end %>
          <li data-toggle="tooltip" data-placement="bottom" title="<%= badge.Experts %>">
            <i class="fa fa-trophy"></i>
            <%= badge.expert_logs.count %>
          </li>
        </ul>
      </td>
    </tr>
  </table>
</div>