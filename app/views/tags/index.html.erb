<% 
  provide(:title, "#{@badge.name} - Badge Wiki")
  provide(:show_subheader, true)
  provide(:subheader_image, group_image_url_for(@group)) 
%>

<% content_for :subheader_links do %>
  <li>
    <%= link_to @group.url_with_caps, @group %>
    <span class="divider">/</span>
  </li>
  <li>
    <%= link_to @badge.url_with_caps, [@group, @badge] %>
    <span class="divider">/</span>
  </li>
  <li class="active">
    Badge Wiki
  </li>
<% end %>

<% if @current_user_is_admin || @current_user_is_member || @group.open? %>
  <% content_for :subheader_actions do %>
    <% if @show_progress && !@current_user_is_expert && !@current_user_is_learner %>
      <li class="collapsible">
        <%= link_to '<i class="fa fa-plus"></i> Join Badge'.html_safe, 
            group_badge_logs_path(@group, @badge), method: :post %>
        <% if @current_user_is_admin %>
          <span class="divider">|</span>
        <% end %>
      </li>
    <% elsif @current_user_is_expert || @current_user_is_learner %>
      <li  class="collapsible">
        <%= link_to "<i class='fa fa-user'></i> View Your #{@badge.log.capitalize}".html_safe, 
            [@group, @badge, @current_user_log] %>
      </li>
    <% end %>
  <% end %>
<% end %>

<!-- === PAGE HEADER === -->

<div class="row add-top-margin">
  <div class="span12">
    <div class="header-card badge-entries-header-card">
      <div class="white-background no-tabs">&nbsp;</div>

      <div class="primary-header span6">
        <span class="header-image">
          <%= link_to image_tag(@badge.image_url(:medium)), [@group, @badge], 
            title: 'View badge' %>
        </span>
        <span class="header-text">
          <h1><%= link_to @badge.name, [@group, @badge], title: 'View badge' %></h1>
          <h2>
            <%= link_to @group.url_with_caps, @group, 
              title: @group.name %>/<%= link_to @badge.url_with_caps, [@group, @badge], 
              title: "View badge" %>
          </h2>
          <h3>
            <%= @badge.summary %>
          </h3>
        </span>
      </div>

      <div class="secondary-header span6">
        <% if @group.public? || @current_user_is_admin || @current_user_is_member || @badge_list_admin %>
          <span class="header-text">
            <h1>Badge Wiki</h1>
          </span>     
        <% end %>       
      </div>
    </div>
  </div>
</div>

<% if @group.public? || @current_user_is_admin || @current_user_is_member || @badge_list_admin %>

  <!-- === ENTRIES LIST === -->

  <% if @topics.blank? %>
  
    <div class="row">
      <div class="well tertiary span7 offset2">
        <h3>No wiki pages yet...</h3>
        <p>
          No wiki pages have been created yet for this badge.
        </p>
        <p>
          To create a wiki page just type any sub-url of the badge into your browser's location bar
          (such as "<%= "/#{@group.url}/#{@badge.url}/example-page" %>"), then click the 
          <strong>"Create new wiki page here"</strong> button.
        </p>
      </div>
    </div>

  <% else %>

    <div class="row">
      <div class="span12">
        <div class="info-card text-card topic-list-card">
          <ul>
            <% @topics.each do |topic| %>
              <li>
                <%= link_to "<i class='fa fa-file'></i> #{topic.display_name}".html_safe, 
                  group_badge_path(@group, @badge) + "/" + topic.name_with_caps %>
              </li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>

  <% end %>

<% else %>
  
  <div class="row">
    <div class="well span7 offset2">
      <h3>This is a private badge</h3>
      <p>
        The contents of this badge are only visible to group members.
      </p>
    </div>
  </div>

<% end %>