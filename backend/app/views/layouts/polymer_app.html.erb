<!DOCTYPE html>
<html>

<%
  
  #=== POLYMER APP LAYOUT ===#
  #------------------------------
  # This layout is used to display the polymer-only APP UI contained in '/frontend/app'.
  # The polymer only app doesn't use any of the features of the Rails views, routing is handled
  # by the polymer frontend and everything is served from a single controller action.

%>

  <head>
    <% #=== GOOGLE TAG MANAGER (Loads Google Analytics, Intercom, etc.) - TAG 1 OF 2 ===# %>
    <%= render 'layouts/shared/google_tag_manager_head' %>

    <% #=== PAGE TITLE, APP ICON & BASE ===# %>
    <title>Badge List</title>
    <link rel="icon" type="image/png" href="<%= image_path('badge-list-icon-32-square.png') %>"/>
    
    <% #=== SAFARI WEB APP SETTINGS ===# %>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Badge List">
    <link rel="apple-touch-icon" href="https://badgelist.s3.amazonaws.com/images/badge-list-icon.png">
    <meta name="apple-mobile-web-app-status-bar-style" content="#FF9800">

    <% #=== METADATA ===# %>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
    <meta name="description" 
      content="Badge List is a platform for awarding digital credentials compatible with the OpenBadge standard.">
    <link rel="manifest" href="<%= @polymer_app_root_url %>/manifest.json">

    <% #=== ICONS ===# %>
    <%= stylesheet_link_tag 'shared/bl-icons/style', media: 'all' %>

    <!-- #=== SWAGGER JS CLIENT ===# -->
    <%= javascript_include_tag 'shared/swagger-js/swagger-client.min.js' %>

    <% #=== POLYMER ===# %>
    <script src="<%= @polymer_app_root_url %>/bower_components/webcomponentsjs/webcomponents-lite.js"></script>
    <script>
      // Configure Polymer global settings *before* import
      window.Polymer = {
        rootPath: '<%= @polymer_app_root_url %>'
      };
    </script>
    <link rel="import" href="<%= @polymer_app_root_url %>/src/bl-app/bl-app.html">

    <% #=== BADGE LIST SERVICE WORKER SCRIPT ===# %>
    <%= render 'layouts/shared/service_worker_script' %>
    
    <% #=== INTERCOM ===# %>
    <%= render 'layouts/shared/intercom' %>
  </head>

  <style type="text/css">

    body { margin: 0; }

    #bodyLoading {
      position: fixed;
      top: 0; right: 0; bottom: 0; left: 0;

      flex-direction: column;
      justify-content: center;
      
      font-family: 'Roboto', 'Lato', 'Helvetica Neue', Arial, sans-serif;
      font-weight: bold;
      font-size: 35px;
      
      background: linear-gradient(160deg, #f5f5f5, #bdbdbd);
      color: white;
      
      display: none;
    }
    body.loading #bodyLoading {
      display: flex;
    }
      #bodyLoadingInner {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: center;
      }
        #bodyLoadingInner img { 
          height: 1.3em; 
          margin-right: 0.5em;
        }
        
  </style>

  <% #=== PAGE BODY ===# %>
  <body class="loading">
    <% #=== GOOGLE TAG MANAGER (Loads Google Analytics, Intercom, etc.) - TAG 2 OF 2 ===# %>
    <%= render 'layouts/shared/google_tag_manager_body' %>

    <%= yield %>

    <div id="bodyLoading">
      <div id="bodyLoadingInner">
        <img src="https://s3.amazonaws.com/badgelist/images/ripple-spinner.gif">
        <div>Loading...</div>
      </div>
    </div>

    <% #=== BADGE LIST SERVICE WORKER UI ===# %>
    <%= render 'layouts/shared/service_worker_ui' %>

  </body>

</html>